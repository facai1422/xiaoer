# ğŸš¨ ç®¡ç†å‘˜è´¦å·å®‰å…¨ä¿®å¤å»ºè®®

## ğŸ”´ å½“å‰å®‰å…¨é—®é¢˜

### å‘ç°çš„ç¡¬ç¼–ç è´¦å·å’Œå¯†ç 

#### 1. ç™»å½•é¡µé¢ç¡¬ç¼–ç  (`src/pages/admin/Login.tsx`)
```javascript
const adminCredentials = {
  'it@haixin.org': ['aa888990', '123456', 'admin123', 'password'],
  'it@haixin.com': ['123456', 'aa888990', 'admin123', 'password'],
  'admin@example.com': ['admin123', '123456', 'aa888990', 'password']
};

const universalPasswords = ['123456', 'admin', 'password', 'test123'];
```

#### 2. é»˜è®¤è´¦å·é…ç½® (`src/utils/adminAuth.ts`)
```javascript
export const DEFAULT_ADMIN_ACCOUNTS = [
  { email: 'admin@example.com', password: 'admin123', role: 'super_admin' },
  { email: 'test@admin.com', password: 'test123', role: 'admin' },
  { email: 'dev@admin.com', password: 'dev123', role: 'admin' }
];
```

#### 3. æ•°æ®åº“å‡½æ•°ç¡¬ç¼–ç 
```sql
-- å¤šå¤„ç¡¬ç¼–ç ç®¡ç†å‘˜é‚®ç®±
'it@haixin.org', 'admin@haixin.org', 'super@haixin.org'
```

## ğŸ›¡ï¸ å®‰å…¨ä¿®å¤æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šç¯å¢ƒå˜é‡é…ç½®ï¼ˆæ¨èï¼‰

#### 1.1 åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶
```bash
# .env.local (ä¸è¦æäº¤åˆ°ä»£ç åº“)
ADMIN_EMAIL_1=your-admin@company.com
ADMIN_PASSWORD_1=your-secure-password-here
ADMIN_EMAIL_2=backup-admin@company.com  
ADMIN_PASSWORD_2=another-secure-password
```

#### 1.2 ä¿®æ”¹ç™»å½•éªŒè¯é€»è¾‘
```typescript
// src/utils/adminAuth.ts
const getAdminCredentials = () => {
  return {
    [process.env.ADMIN_EMAIL_1 || '']: process.env.ADMIN_PASSWORD_1 || '',
    [process.env.ADMIN_EMAIL_2 || '']: process.env.ADMIN_PASSWORD_2 || '',
  };
};

export const verifyAdminCredentials = (email: string, password: string): boolean => {
  const credentials = getAdminCredentials();
  return credentials[email] === password;
};
```

### æ–¹æ¡ˆ2ï¼šæ•°æ®åº“å­˜å‚¨ï¼ˆæœ€å®‰å…¨ï¼‰

#### 2.1 åˆ›å»ºç®¡ç†å‘˜è¡¨
```sql
CREATE TABLE admin_users (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  email VARCHAR(255) UNIQUE NOT NULL,
  password_hash VARCHAR(255) NOT NULL,
  salt VARCHAR(255) NOT NULL,
  role VARCHAR(50) DEFAULT 'admin',
  is_super_admin BOOLEAN DEFAULT FALSE,
  is_active BOOLEAN DEFAULT TRUE,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW(),
  last_login_at TIMESTAMPTZ,
  failed_login_attempts INTEGER DEFAULT 0,
  locked_until TIMESTAMPTZ
);
```

#### 2.2 å¯†ç åŠ å¯†å­˜å‚¨
```typescript
import bcrypt from 'bcryptjs';
import crypto from 'crypto';

export const hashPassword = async (password: string): Promise<{hash: string, salt: string}> => {
  const salt = crypto.randomBytes(32).toString('hex');
  const hash = await bcrypt.hash(password + salt, 12);
  return { hash, salt };
};

export const verifyPassword = async (
  password: string, 
  hash: string, 
  salt: string
): Promise<boolean> => {
  return await bcrypt.compare(password + salt, hash);
};
```

### æ–¹æ¡ˆ3ï¼šé›†æˆèº«ä»½è®¤è¯æœåŠ¡

#### 3.1 ä½¿ç”¨Supabase Auth
```typescript
// ä½¿ç”¨Supabaseå†…ç½®è®¤è¯ç³»ç»Ÿ
export const adminLogin = async (email: string, password: string) => {
  const { data, error } = await supabase.auth.signInWithPassword({
    email,
    password,
  });
  
  if (error) throw error;
  
  // éªŒè¯ç”¨æˆ·æ˜¯å¦æ˜¯ç®¡ç†å‘˜
  const { data: adminProfile } = await supabase
    .from('admin_profiles')
    .select('*')
    .eq('user_id', data.user.id)
    .eq('is_active', true)
    .single();
    
  if (!adminProfile) {
    throw new Error('éç®¡ç†å‘˜è´¦å·');
  }
  
  return { user: data.user, admin: adminProfile };
};
```

#### 3.2 ä½¿ç”¨ç¬¬ä¸‰æ–¹è®¤è¯
- Auth0
- Firebase Auth
- AWS Cognito
- Azure AD

## ğŸš€ ç«‹å³è¡ŒåŠ¨è®¡åˆ’

### ç¬¬ä¸€é˜¶æ®µï¼šç´§æ€¥ä¿®å¤ï¼ˆ1-2å¤©ï¼‰

1. **ç§»é™¤æ‰€æœ‰ç¡¬ç¼–ç å¯†ç **
   ```bash
   # æœç´¢å¹¶åˆ é™¤æ‰€æœ‰ç¡¬ç¼–ç å¯†ç 
   grep -r "123456\|admin123\|password\|aa888990" src/
   ```

2. **åˆ›å»ºä¸´æ—¶ç¯å¢ƒå˜é‡é…ç½®**
   ```bash
   # .env.local
   VITE_ADMIN_EMAIL=your-secure-admin@company.com
   VITE_ADMIN_PASSWORD=your-very-secure-password-here
   ```

3. **æ›´æ–°ç™»å½•éªŒè¯é€»è¾‘**
   ```typescript
   const verifyPassword = (inputPassword: string, email: string): boolean => {
     const adminEmail = import.meta.env.VITE_ADMIN_EMAIL;
     const adminPassword = import.meta.env.VITE_ADMIN_PASSWORD;
     
     return email === adminEmail && inputPassword === adminPassword;
   };
   ```

### ç¬¬äºŒé˜¶æ®µï¼šå®‰å…¨åŠ å›ºï¼ˆ1å‘¨ï¼‰

1. **å®æ–½å¯†ç åŠ å¯†**
2. **æ·»åŠ ç™»å½•å¤±è´¥é™åˆ¶**
3. **å®æ–½ä¼šè¯ç®¡ç†**
4. **æ·»åŠ æ“ä½œæ—¥å¿—**

### ç¬¬ä¸‰é˜¶æ®µï¼šå®Œæ•´è®¤è¯ç³»ç»Ÿï¼ˆ2-3å‘¨ï¼‰

1. **é›†æˆSupabase Auth**
2. **å®æ–½è§’è‰²æƒé™ç³»ç»Ÿ**
3. **æ·»åŠ å¤šå› ç´ è®¤è¯**
4. **å®æ–½å®‰å…¨å®¡è®¡**

## ğŸ“‹ å®‰å…¨æ£€æŸ¥æ¸…å•

- [ ] ç§»é™¤æ‰€æœ‰ç¡¬ç¼–ç å¯†ç 
- [ ] å®æ–½ç¯å¢ƒå˜é‡é…ç½®
- [ ] æ·»åŠ å¯†ç å¼ºåº¦éªŒè¯
- [ ] å®æ–½ç™»å½•å¤±è´¥é™åˆ¶
- [ ] æ·»åŠ ä¼šè¯è¶…æ—¶æœºåˆ¶
- [ ] å®æ–½æ“ä½œæ—¥å¿—è®°å½•
- [ ] é…ç½®HTTPSå¼ºåˆ¶
- [ ] æ·»åŠ CSRFä¿æŠ¤
- [ ] å®æ–½SQLæ³¨å…¥é˜²æŠ¤
- [ ] é…ç½®å®‰å…¨å¤´éƒ¨

## âš ï¸ é‡è¦æé†’

1. **ç«‹å³æ›´æ”¹æ‰€æœ‰é»˜è®¤å¯†ç **
2. **ä¸è¦å°†æ•æ„Ÿä¿¡æ¯æäº¤åˆ°ä»£ç åº“**
3. **å®šæœŸè½®æ¢ç®¡ç†å‘˜å¯†ç **
4. **ç›‘æ§å¼‚å¸¸ç™»å½•æ´»åŠ¨**
5. **å®šæœŸå®‰å…¨å®¡è®¡**

## ğŸ”— ç›¸å…³èµ„æº

- [OWASPè®¤è¯å¤‡å¿˜å•](https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html)
- [Supabaseè®¤è¯æ–‡æ¡£](https://supabase.com/docs/guides/auth)
- [å¯†ç å®‰å…¨æœ€ä½³å®è·µ](https://auth0.com/blog/password-security-best-practices/)

---

**ä¼˜å…ˆçº§**: ğŸ”´ **ç´§æ€¥**
**é£é™©ç­‰çº§**: ğŸ”´ **é«˜å±**
**ä¿®å¤æ—¶é—´**: ç«‹å³å¼€å§‹ 